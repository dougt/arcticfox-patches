# HG changeset patch
# User Ted Mielczarek <ted.mielczarek@gmail.com>
# Date 1272373063 14400
# Node ID c14f2fbfe69d8c097c848ac9ba02f466dd75d6cf
# Parent  3708d874f7ee10b441f02046d94a8b5df6729199
imported patch uikit-http-user-agent

diff --git a/netwerk/protocol/http/src/nsHttpHandler.cpp b/netwerk/protocol/http/src/nsHttpHandler.cpp
--- a/netwerk/protocol/http/src/nsHttpHandler.cpp
+++ b/netwerk/protocol/http/src/nsHttpHandler.cpp
@@ -85,7 +85,7 @@
 #include <windows.h>
 #endif
 
-#if defined(XP_MACOSX)
+#if defined(MOZ_WIDGET_COCOA)
 #include <CoreServices/CoreServices.h>
 #endif
 
@@ -672,8 +672,10 @@
     "OS/2"
 #elif defined(XP_WIN)
     "Windows"
-#elif defined(XP_MACOSX)
+#elif defined(MOZ_WIDGET_COCOA)
     "Macintosh"
+#elif defined(MOZ_WIDGET_UIKIT)
+    "iPhone"
 #elif defined(XP_BEOS)
     "BeOS"
 #elif defined(MOZ_X11)
@@ -713,7 +715,7 @@
             PR_smprintf_free(buf);
         }
     }
-#elif defined (XP_MACOSX)
+#elif defined (MOZ_WIDGET_COCOA)
 #if defined(__ppc__)
     mOscpu.AssignLiteral("PPC Mac OS X");
 #elif defined(__i386__) || defined(__x86_64__)
@@ -724,6 +726,13 @@
         (::Gestalt(gestaltSystemVersionMinor, &minorVersion) == noErr)) {
         mOscpu += nsPrintfCString(" %d.%d", majorVersion, minorVersion);
     }
+#elif defined(MOZ_WIDGET_UIKIT)
+#if defined(__arm___)
+    mOscpu.AssignLiteral("ARM iPhoneOS");
+#elif defined(__i386__) || defined(__x86_64__)
+    mOscpu.AssignLiteral("Intel iPhoneOS");
+#endif
+    //XXX: [[UIDevice currentDevice] systemVersion]
 #elif defined (XP_UNIX) || defined (XP_BEOS)
     struct utsname name;
     
