# HG changeset patch
# User Ted Mielczarek <ted.mielczarek@gmail.com>
# Date 1290861141 18000
# Node ID c1709027f171d45b0c31c0f49743871e35b9bc60
# Parent  5d76c42cf8535caac955c04d2631dc1e595621c9
imported patch fix-media-event

diff --git a/content/events/src/nsEventListenerManager.cpp b/content/events/src/nsEventListenerManager.cpp
--- a/content/events/src/nsEventListenerManager.cpp
+++ b/content/events/src/nsEventListenerManager.cpp
@@ -474,12 +474,14 @@
     if (window) {
       window->SetHasPaintEventListeners();
     }
+#ifdef MOZ_MEDIA
   } else if (aType == NS_MOZAUDIOAVAILABLE) {
     mMayHaveAudioAvailableEventListener = PR_TRUE;
     nsPIDOMWindow* window = GetInnerWindowForTarget();
     if (window) {
       window->SetHasAudioAvailableEventListeners();
     }
+#endif
   } else if (aType >= NS_MUTATION_START && aType <= NS_MUTATION_END) {
     // For mutation listeners, we need to update the global bit on the DOM window.
     // Otherwise we won't actually fire the mutation event.
