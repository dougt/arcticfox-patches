diff --git a/toolkit/xre/nsAppRunner.cpp b/toolkit/xre/nsAppRunner.cpp
--- a/toolkit/xre/nsAppRunner.cpp
+++ b/toolkit/xre/nsAppRunner.cpp
@@ -170,9 +170,6 @@
 
 #ifdef MOZ_WIDGET_COCOA
 #include "nsILocalFileMac.h"
-#endif
-
-#ifdef XP_MACOSX
 #include "nsCommandLineServiceMac.h"
 #endif
 
@@ -1752,7 +1749,7 @@
 
   SaveToEnv("MOZ_LAUNCHED_CHILD=1");
 
-#if defined(XP_MACOSX)
+#if defined(MOZ_WIDGET_COCOA)
   SetupMacCommandLine(gRestartArgc, gRestartArgv, PR_TRUE);
   LaunchChildMac(gRestartArgc, gRestartArgv);
 #else
@@ -1957,7 +1954,7 @@
     rv |= xpcom.SetWindowCreator(aNative);
     NS_ENSURE_SUCCESS(rv, NS_ERROR_FAILURE);
 
-#ifdef XP_MACOSX
+#ifdef MOZ_WIDGET_COCOA
     SetupMacCommandLine(gRestartArgc, gRestartArgv, PR_TRUE);
 #endif
 
@@ -2047,7 +2044,7 @@
       xpcom.DoAutoreg();
       xpcom.RegisterProfileService();
 
-#ifdef XP_MACOSX
+#ifdef MOZ_WIDGET_COCOA
       SetupMacCommandLine(gRestartArgc, gRestartArgv, PR_TRUE);
 #endif
 
@@ -3510,7 +3507,7 @@
             }
 #endif
 
-#ifdef XP_MACOSX
+#ifdef MOZ_WIDGET_COCOA
             // we re-initialize the command-line service and do appleevents munging
             // after we are sure that we're not restarting
             cmdLine = do_CreateInstance("@mozilla.org/toolkit/command-line;1");
@@ -3521,8 +3518,7 @@
             rv = cmdLine->Init(gArgc, gArgv,
                                workingDir, nsICommandLine::STATE_INITIAL_LAUNCH);
             NS_ENSURE_SUCCESS(rv, 1);
-#endif
-#ifdef MOZ_WIDGET_COCOA
+
             // Prepare Cocoa's form of Apple Event handling.
             SetupMacApplicationDelegate();
 #endif
@@ -3608,7 +3604,7 @@
           ProcessDDE(nativeApp, PR_TRUE);
 #endif
 
-#ifdef XP_MACOSX
+#ifdef MOZ_WIDGET_COCOA
           SetupMacCommandLine(gRestartArgc, gRestartArgv, PR_TRUE);
 #endif
         }
