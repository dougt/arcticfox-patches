# HG changeset patch
# User Ted Mielczarek <ted.mielczarek@gmail.com>
# Date 1272373063 14400
# Node ID 4ea1619ad917eca1ee0df448b9f442f57cce0e46
# Parent  ad1cba01de6e451d7e3f9046891dc77c45afa7fb
imported patch script-security-manager-plugins

diff --git a/caps/src/nsScriptSecurityManager.cpp b/caps/src/nsScriptSecurityManager.cpp
--- a/caps/src/nsScriptSecurityManager.cpp
+++ b/caps/src/nsScriptSecurityManager.cpp
@@ -72,7 +72,9 @@
 #include "nsIFile.h"
 #include "nsIFileURL.h"
 #include "nsIZipReader.h"
+#ifdef MOZ_PLUGINS
 #include "nsIPluginInstance.h"
+#endif
 #include "nsIXPConnect.h"
 #include "nsIScriptGlobalObject.h"
 #include "nsPIDOMWindow.h"
@@ -3217,6 +3219,7 @@
         }
     }
 
+#ifdef MOZ_PLUGINS
     //-- If user allows scripting of plugins by untrusted scripts,
     //   and the target object is a plugin, allow the access.
     if(aObj)
@@ -3237,6 +3240,7 @@
                 return NS_OK;
         }
     }
+#endif
 
     //-- Access tests failed
     return NS_ERROR_DOM_XPCONNECT_ACCESS_DENIED;
