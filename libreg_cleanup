diff --git a/modules/libreg/Makefile.in b/modules/libreg/Makefile.in
--- a/modules/libreg/Makefile.in
+++ b/modules/libreg/Makefile.in
@@ -44,7 +44,7 @@
 
 MODULE		= libreg
 
-DIRS		= include src standalone
+DIRS		= include src #standalone
 
 include $(topsrcdir)/config/rules.mk
 
diff --git a/modules/libreg/src/VerReg.c b/modules/libreg/src/VerReg.c
--- a/modules/libreg/src/VerReg.c
+++ b/modules/libreg/src/VerReg.c
@@ -76,7 +76,7 @@
 #include "NSReg.h"
 #include "VerReg.h"
 
-#if defined(XP_MAC) || defined(XP_MACOSX)
+#if defined(XP_MAC) || defined(XP_MACOSX) && !defined(IPHONE)
 #include <Folders.h>
 #endif
 
@@ -158,7 +158,7 @@
 static REGERR vr_convertPackageName(char *regPackageName, char *convertedPackageName, uint32 convertedDataLength);
 static REGERR vr_unmanglePackageName(char *mangledPackageName, char *regPackageName, uint32 regPackageLength);
 
-#if defined(XP_MAC) || defined(XP_MACOSX)
+#if defined(XP_MAC) || defined(XP_MACOSX) && !defined(IPHONE)
 static void vr_MacAliasFromPath(const char * fileName, void ** alias, int32 * length);
 static char * vr_PathFromMacAlias(const void * alias, uint32 aliasLength);
 #endif
@@ -290,7 +290,7 @@
 #if defined(XP_WIN) || defined(XP_OS2)
 #define VR_FILE_SEP '\\'
 #endif
-#if defined(XP_MAC) || defined(XP_MACOSX)
+#if defined(XP_MAC) || defined(XP_MACOSX) && !defined(IPHONE)
 #define VR_FILE_SEP ':'
 #endif
 #ifdef XP_BEOS
diff --git a/modules/libreg/src/nr_bufio.c b/modules/libreg/src/nr_bufio.c
--- a/modules/libreg/src/nr_bufio.c
+++ b/modules/libreg/src/nr_bufio.c
@@ -52,7 +52,7 @@
 #include <stdio.h>
 #include <string.h>
 #include <errno.h>
-#if defined(XP_MAC) || defined(XP_MACOSX)
+#if defined(XP_MAC) || defined(XP_MACOSX) && !defined(IPHONE)
   #include <Errors.h>
 #endif
 
@@ -207,7 +207,7 @@
         switch (errno)
         {
             /* file not found */
-#if defined(XP_MAC) || defined(XP_MACOSX)
+#if defined(XP_MAC) || defined(XP_MACOSX) && !defined(IPHONE)
             case fnfErr:
 #else
             case ENOENT:
@@ -216,7 +216,7 @@
                 break;
 
             /* file in use */
-#if defined(XP_MAC) || defined(XP_MACOSX)
+#if defined(XP_MAC) || defined(XP_MACOSX) && !defined(IPHONE)
             case opWrErr:
 #else
             case EACCES:
diff --git a/modules/libreg/src/reg.c b/modules/libreg/src/reg.c
--- a/modules/libreg/src/reg.c
+++ b/modules/libreg/src/reg.c
@@ -65,7 +65,7 @@
 #include <stdio.h>
 #include <string.h>
 
-#ifdef XP_MACOSX
+#if defined(XP_MACOSX) && !defined(IPHONE)
 #include <Carbon/Carbon.h>
 #endif
 
@@ -151,7 +151,7 @@
 char            *globalRegName = NULL;
 static char     *user_name = NULL;
 
-#ifdef XP_MACOSX
+#if defined(XP_MACOSX) && !defined(IPHONE)
 
 void nr_MacAliasFromPath(const char * fileName, void ** alias, int32 * length);
 char * nr_PathFromMacAlias(const void * alias, uint32 aliasLength);
@@ -384,7 +384,7 @@
     {
         switch (errno)
         {
-#ifdef XP_MACOSX
+#if defined(XP_MACOSX) && !defined(IPHONE)
         case fnfErr:
 #else
         case ENOENT:    /* file not found */
diff --git a/modules/libreg/src/vr_stubs.c b/modules/libreg/src/vr_stubs.c
--- a/modules/libreg/src/vr_stubs.c
+++ b/modules/libreg/src/vr_stubs.c
@@ -54,7 +54,7 @@
 
 #include "vr_stubs.h"
 
-#ifdef XP_MACOSX
+#if defined(XP_MACOSX) && !defined(IPHONE)
 #include <Carbon/Carbon.h>
 #include <stdlib.h>
 #endif
@@ -63,7 +63,7 @@
 #include <FindDirectory.h>
 #endif 
 
-#ifdef XP_MACOSX
+#if defined(XP_MACOSX) && !defined(IPHONE)
 /* So that we're not dependent on the size of chars in a wide string literal */
 static const UniChar kOSXRegParentName[] =
   { 'M', 'o', 'z', 'i', 'l', 'l', 'a' };
@@ -222,7 +222,7 @@
  * ------------------------------------------------------------------
  */
 
-#if defined(XP_MAC) || defined(XP_MACOSX)
+#if defined(XP_MAC) || defined(XP_MACOSX) && !defined(IPHONE)
 #include <Files.h>
 
 #ifdef STANDALONE_REGISTRY
@@ -248,7 +248,7 @@
 }
 #endif /*STANDALONE_REGISTRY*/
 
-#if defined (XP_MACOSX)
+#if defined (XP_MACOSX) && !defined(IPHONE)
 extern void vr_findGlobalRegName()
 {
     OSErr   err;
@@ -345,7 +345,7 @@
 }
 #endif /* XP_MACOSX */
 
-#ifdef XP_MACOSX
+#if defined(XP_MACOSX) && !defined(IPHONE)
 extern char* vr_findVerRegName()
 {
     OSErr   err;
